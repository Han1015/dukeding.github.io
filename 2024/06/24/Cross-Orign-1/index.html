

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/dukeding.github.io/img/fluid/favicon.ico">
  <link rel="icon" href="/dukeding.github.io/img/fluid/favicon.ico">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Xiaohan Ding">
  <meta name="keywords" content="Full Stack Developer, React, Node.js, SEO Optimization, API Development, Front-end, Back-end, Web Development, Page Optimization, Xiaohan Ding">
  
    <meta name="description" content="What is CORSThe CORS error message1request has been blocked by CORS policy: No &#x27;Access-Control-Allow-Origin&#x27; header is present on the requested resource. I believe that the above errors can">
<meta property="og:type" content="article">
<meta property="og:title" content="Cross Orign 1">
<meta property="og:url" content="https://han1015.github.io/dukeding.github.io/2024/06/24/Cross-Orign-1/index.html">
<meta property="og:site_name" content="Xiaohan Ding - Full Stack Developer">
<meta property="og:description" content="What is CORSThe CORS error message1request has been blocked by CORS policy: No &#x27;Access-Control-Allow-Origin&#x27; header is present on the requested resource. I believe that the above errors can">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://han1015.github.io/dukeding.github.io/img/Images-Cross-Orign/fetch-mode.png">
<meta property="article:published_time" content="2024-06-24T11:36:11.000Z">
<meta property="article:modified_time" content="2025-01-16T23:07:21.290Z">
<meta property="article:author" content="Xiaohan Ding">
<meta property="article:tag" content="Full Stack Developer, React, Node.js, SEO Optimization, API Development, Front-end, Back-end, Web Development, Page Optimization, Xiaohan Ding">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://han1015.github.io/dukeding.github.io/img/Images-Cross-Orign/fetch-mode.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Cross Orign 1 - Xiaohan Ding - Full Stack Developer</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/dukeding.github.io/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/dukeding.github.io/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/dukeding.github.io/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"han1015.github.io","root":"/dukeding.github.io/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":true,"follow_dnt":true,"baidu":null,"google":{"measurement_id":"G-ZZ9467GFZS"},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/dukeding.github.io/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/dukeding.github.io/js/utils.js" ></script>
  <script  src="/dukeding.github.io/js/color-schema.js" ></script>
  

  

  
    <!-- Google tag (gtag.js) -->
    <script async>
      console.log('!Fluid.ctx.dnt', !Fluid.ctx.dnt)
      if (!Fluid.ctx.dnt) {
        Fluid.utils.createScript("https://www.googletagmanager.com/gtag/js?id=G-ZZ9467GFZS", function() {
          window.dataLayer = window.dataLayer || [];
          function gtag() {
            dataLayer.push(arguments);
          }
          gtag('js', new Date());
          gtag('config', 'G-ZZ9467GFZS');
        });
      }
    </script>
  

  

  

  

  



  
<meta name="generator" content="Hexo 7.1.1"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/dukeding.github.io/">
      <strong>Duke&#39;s Blog</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/dukeding.github.io/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/dukeding.github.io/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/dukeding.github.io/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/dukeding.github.io/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/dukeding.github.io/about/" target="_self">
                <i class="iconfont icon-user-fill"></i>
                <span>About</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/dukeding.github.io/img/default.png') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Cross Orign 1"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-06-24 21:36" pubdate>
          June 24, 2024 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          534 words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          9 mins
        
      </span>
    

    
    
      
        <span id="busuanzi_container_page_pv" style="display: none">
          <i class="iconfont icon-eye" aria-hidden="true"></i>
          <span id="busuanzi_value_page_pv"></span> views
        </span>
        
      
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">Cross Orign 1</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="What-is-CORS"><a href="#What-is-CORS" class="headerlink" title="What is CORS"></a>What is CORS</h2><h3 id="The-CORS-error-message"><a href="#The-CORS-error-message" class="headerlink" title="The CORS error message"></a>The <strong>CORS</strong> error message</h3><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">request has been blocked <span class="hljs-keyword">by</span> CORS <span class="hljs-keyword">policy</span>: <span class="hljs-keyword">No</span> <span class="hljs-string">&#x27;Access-Control-Allow-Origin&#x27;</span> <span class="hljs-keyword">header</span> <span class="hljs-keyword">is</span> present <span class="hljs-keyword">on</span> the requested resource.<br></code></pre></td></tr></table></figure>
<p>I believe that the above errors can often occur when the front-end initiates a request, and many developers may not know how to solve them, or even who to solve them. In fact, this is a typical <strong>CORS</strong>, and the vast majority of these situations cannot be solved by the front-end, because prohibiting cross domain access is originally a <strong>web security</strong> specification. If the front-end can bypass it, what security significance does it have?</p>
<h3 id="What-is-Cross-Orign"><a href="#What-is-Cross-Orign" class="headerlink" title="What is Cross Orign"></a>What is <strong>Cross Orign</strong></h3><p>The commonly used term ‘<strong>cross origin</strong>‘ actually refers to resource requests that span different origins. <strong>Same Origin</strong> is a network security concept used to define whether two URLs belong to the same Origin. Same Origin Policy is a security mechanism used by browsers to restrict interactions between different sources and protect user data from malicious websites.</p>
<h4 id="How-to-Determine-if-Two-URLs-Are-Same-Origin"><a href="#How-to-Determine-if-Two-URLs-Are-Same-Origin" class="headerlink" title="How to Determine if Two URLs Are Same-Origin"></a>How to Determine if Two URLs Are Same-Origin</h4><p>Two URLs are considered to have the same origin if they share:<br><strong>Protocol</strong> (e.g., http or https)<br><strong>Domain</strong> (e.g., example.com)<br><strong>Port</strong> (e.g., :80, :443)</p>
<p>The Same-Origin Policy focuses on protecting sensitive user data (like cookies, DOM, and storage) rather than restricting external resources. Allowing unrestricted use of<br>&lt;script&gt;, &lt;video&gt;, and &lt;img&gt; ensures the web remains functional while other safeguards like CORS and CSP mitigate potential security risks. The interactions restricted by the Same-Origin Policy include the following three types:</p>
<figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs vim">Cross-Origin Network Access:<br><span class="hljs-number">1</span>. This includes resources loaded via XMLHttpRequest, fetch, <span class="hljs-built_in">or</span> elements such <span class="hljs-keyword">as</span> <span class="hljs-symbol">&lt;script&gt;</span>, <span class="hljs-symbol">&lt;link&gt;</span>, <span class="hljs-symbol">&lt;img&gt;</span>, <span class="hljs-symbol">&lt;video&gt;</span>, <span class="hljs-symbol">&lt;audio&gt;</span>, <span class="hljs-symbol">&lt;object&gt;</span>, <span class="hljs-symbol">&lt;embed&gt;</span>, <span class="hljs-built_in">and</span> <span class="hljs-symbol">&lt;iframe&gt;</span>.<br><br><span class="hljs-number">2</span>. Cross-Origin DOM <span class="hljs-built_in">and</span> API Access:<br>This mainly refers <span class="hljs-keyword">to</span> restrictions <span class="hljs-keyword">on</span> accessing the content of iframe elements <span class="hljs-built_in">and</span> the content of windows opened by window.<span class="hljs-keyword">open</span>.<br><br><span class="hljs-number">3</span>. Cross-Origin Data Storage Access:<br>This includes restrictions <span class="hljs-keyword">on</span> accessing cookie, localStorage, <span class="hljs-built_in">and</span> IndexedDB.<br></code></pre></td></tr></table></figure>

<h3 id="How-to-solve-cross-domain-DOM-access"><a href="#How-to-solve-cross-domain-DOM-access" class="headerlink" title="How to solve cross domain DOM access?"></a>How to solve cross domain DOM access?</h3><ol>
<li>postMessage<br>Window.postMessage () is an HTML5 API that enables communication between the main page and newly opened windows, as well as between created iframes.</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// In the parent page file</span><br><span class="hljs-keyword">const</span> childWindow = <span class="hljs-variable language_">window</span>.<span class="hljs-title function_">open</span>(<span class="hljs-string">&#x27;http://localhost:8080/child-page.html&#x27;</span>, <span class="hljs-string">&#x27;title&#x27;</span>);<br>childWindow.<span class="hljs-title function_">postMessage</span>(<span class="hljs-string">&#x27;hello word&#x27;</span>, <span class="hljs-string">&#x27;http://localhost:8080/child-page.html&#x27;</span>);<br><br><span class="hljs-comment">// In the child page file</span><br><span class="hljs-variable language_">window</span>.<span class="hljs-title function_">addEventListener</span>(<br>  <span class="hljs-string">&#x27;message&#x27;</span>,<br>  <span class="hljs-function"><span class="hljs-params">e</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">source</span>); <span class="hljs-comment">// the sender&#x27;s window</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">origin</span>); <span class="hljs-comment">// the sender&#x27;s url</span><br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(e.<span class="hljs-property">data</span>); <span class="hljs-comment">// the send data</span><br>  &#125;,<br>  <span class="hljs-literal">false</span><br>);<br></code></pre></td></tr></table></figure>
<ol start="2">
<li>document.domain<br>This method is only suitable for situations where the main domain name is the same, such as when xxx.com opens the <a target="_blank" rel="noopener" href="http://www.xxx.com/">www.xxx.com</a> page. In this case, you can modify document.domain to xxx.com, so that you can access the other party’s window object and all objects it executes.</li>
</ol>
<h3 id="How-to-solve-cross-domain-requests"><a href="#How-to-solve-cross-domain-requests" class="headerlink" title="How to solve cross domain requests?"></a>How to solve cross domain requests?</h3><p>In addition to cross domain DOM, API, and other object access, there is also cross domain request access. If it is still necessary to send requests to addresses from different sources, how can we solve the problem of same source policy?<br>There are actually many methods, and a few can be listed first:</p>
<h4 id="1-Disable-browser-security-settings"><a href="#1-Disable-browser-security-settings" class="headerlink" title="1. Disable browser security settings"></a>1. Disable browser security settings</h4><p>The same origin strategy is essentially a restriction imposed by the browser, so as long as this restriction is turned off, it can be resolved. However, this only applies to one’s own device and is a temporary solution that does not address the root cause. How to close each browser can be searched by oneself.</p>
<h4 id="2-set-fet-mode-“no-cors”"><a href="#2-set-fet-mode-“no-cors”" class="headerlink" title="2. set fet mode “no-cors”"></a>2. set fet mode “no-cors”</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-title function_">fetch</span>(<span class="hljs-string">&#x27;http://localhost:8080/user&#x27;</span>, &#123;<br>  <span class="hljs-attr">mode</span>: <span class="hljs-string">&#x27;no-cors&#x27;</span>,<br>  <span class="hljs-attr">method</span>: <span class="hljs-string">&#x27;GET&#x27;</span>,<br>&#125;)<br>  .<span class="hljs-title function_">then</span>(<span class="hljs-function"><span class="hljs-params">res</span> =&gt;</span> &#123;<br>    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(res);<br>    <span class="hljs-keyword">return</span> res.<span class="hljs-title function_">text</span>();<br>  &#125;)<br>  .<span class="hljs-title function_">then</span>(<span class="hljs-variable language_">console</span>.<span class="hljs-property">log</span>);<br></code></pre></td></tr></table></figure>
<p><img src="/dukeding.github.io/img/Images-Cross-Orign/fetch-mode.png" srcset="/dukeding.github.io/img/loading.gif" lazyload alt="Alt Text"></p>
<p>We can see that the status code is <strong>0</strong>, the type is <strong>opaque</strong>, and the received request returns empty, but the console does not report any errors. You can see the correct return within the network of the console.<br>Because of mode:‘ No cors’ does not solve the cross domain problem, but rather tells the browser that you need to send a cross domain request and that you do not care about the return. So, this request will not report any errors, but it will not return any information to the JS, even if the Access Control Allow Origin header has been set. So this setting is only available in certain situations and does not truly solve the problem of cross domain requests.</p>
<h4 id="3-Do-not-use-AJAX-to-retrieve-data"><a href="#3-Do-not-use-AJAX-to-retrieve-data" class="headerlink" title="3. Do not use AJAX to retrieve data"></a>3. Do not use AJAX to retrieve data</h4><p>If the request is not made using AJAX, there is indeed no such restriction, then the only consideration is HTML tags and form forms.</p>
<p>When we send a request and create a script tag, this type of request will not be restricted by the same origin policy:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// Frontend</span><br><span class="hljs-keyword">const</span> <span class="hljs-title function_">request</span> = (<span class="hljs-params">url, data, cb</span>) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> id = <span class="hljs-built_in">parseInt</span>(<span class="hljs-title class_">Math</span>.<span class="hljs-title function_">random</span>() * <span class="hljs-number">10</span> ** <span class="hljs-number">10</span>);<br>  <span class="hljs-keyword">const</span> callbackName = <span class="hljs-string">`callback<span class="hljs-subst">$&#123;id&#125;</span>`</span>;<br>  <span class="hljs-keyword">const</span> urlSearchParams = <span class="hljs-keyword">new</span> <span class="hljs-title class_">URLSearchParams</span>();<br>  <span class="hljs-comment">// send the callback function name to backend</span><br>  urlSearchParams.<span class="hljs-title function_">set</span>(<span class="hljs-string">&#x27;callbackName&#x27;</span>, callbackName);<br>  <span class="hljs-comment">// add params in the url</span><br>  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> &#123;<br>    urlSearchParams.<span class="hljs-title function_">set</span>(key, data[key]);<br>  &#125;);<br>  <span class="hljs-comment">// create the script tag</span><br>  <span class="hljs-keyword">const</span> $script = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;script&#x27;</span>);<br>  $script.<span class="hljs-property">src</span> = <span class="hljs-string">`<span class="hljs-subst">$&#123;url&#125;</span>?<span class="hljs-subst">$&#123;urlSearchParams.toString()&#125;</span>`</span>;<br><br>  <span class="hljs-comment">// set a immediate callback and delete it later</span><br>  <span class="hljs-comment">// add the callback function in the window, used to backend send the response to execute the function</span><br>  <span class="hljs-variable language_">window</span>[callbackName] = <span class="hljs-function">(<span class="hljs-params">...data</span>) =&gt;</span> &#123;<br>    <span class="hljs-title function_">cb</span>(data);<br>    <span class="hljs-keyword">delete</span> <span class="hljs-variable language_">window</span>[callbackName];<br>  &#125;;<br><br>  <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">append</span>($script);<br>&#125;;<br><br><span class="hljs-title function_">request</span>(<span class="hljs-string">&#x27;localhost:8080/info&#x27;</span>, &#123; <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Duke&#x27;</span>, <span class="hljs-attr">id</span>: <span class="hljs-string">&#x27;2024&#x27;</span> &#125;, <span class="hljs-function"><span class="hljs-params">data</span> =&gt;</span> &#123;<br>  <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(<span class="hljs-string">&#x27;Retrieve data:&#x27;</span>, data);<br>&#125;);<br></code></pre></td></tr></table></figure>
<p>Using script tags to bypass cross domain issues and send requests, the server needs to respond to this request and return a JavaScript executable code, triggering our defined temporary callback function and inserting the data:</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-comment">// backend</span><br><span class="hljs-keyword">const</span> express = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;express&#x27;</span>);<br><span class="hljs-keyword">const</span> app = <span class="hljs-title function_">express</span>();<br><br>app.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;/info&#x27;</span>, <span class="hljs-function">(<span class="hljs-params">req, res</span>) =&gt;</span> &#123;<br>  <span class="hljs-keyword">const</span> id = req.<span class="hljs-property">query</span>.<span class="hljs-property">id</span>;<br>  <span class="hljs-keyword">const</span> name = req.<span class="hljs-property">query</span>.<span class="hljs-property">name</span>;<br>  <span class="hljs-keyword">const</span> callbackName = req.<span class="hljs-property">query</span>.<span class="hljs-property">callbackName</span>;<br>  <span class="hljs-comment">// trigger the callback function</span><br>  res.<span class="hljs-title function_">end</span>(<span class="hljs-string">`<span class="hljs-subst">$&#123;callbackName&#125;</span>(<span class="hljs-subst">$&#123;id&#125;</span>,&#x27;<span class="hljs-subst">$&#123;name&#125;</span>&#x27;)`</span>);<br>&#125;);<br></code></pre></td></tr></table></figure>
<p>The front-end passes the data and callback function name to the back-end, and adds the callback function to the window object. The back-end passes the data that needs to be returned to the callback function. After receiving the data, the front-end will directly execute the callback function<br>This is a simple method of sending requests without using AJAX, which is also known as <strong>JSONP</strong> (JSON with Padding). This method was very commonly used when the CORS specification was incomplete in the early days, but its drawbacks were also obvious: only <strong>GET</strong> method can be used. So, how can we send requests for other methods?  </p>
<p>In fact, we can use the form form. The form itself has no cross domain issues and supports multiple methods. However, it will refresh after submission. So we just need to create an iframe and let the form refresh after submission instead of the main page. Just change the form’s target to the named iframe.</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><code class="hljs js"><span class="hljs-keyword">const</span> <span class="hljs-title function_">request</span> = (<span class="hljs-params">url, data, cb</span>) =&gt; &#123;<br>  <span class="hljs-keyword">const</span> $iframe = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;iframe&#x27;</span>);<br>  $iframe.<span class="hljs-property">name</span> = <span class="hljs-string">&#x27;request&#x27;</span>;<br>  $iframe.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&#x27;none&#x27;</span>;<br><br>  $iframe.<span class="hljs-title function_">addEventListener</span>(<span class="hljs-string">&#x27;load&#x27;</span>, cb);<br><br>  <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>($iframe);<br><br>  <span class="hljs-keyword">const</span> $form = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;form&#x27;</span>);<br><br>  $form.<span class="hljs-property">action</span> = url;<br>  $form.<span class="hljs-property">target</span> = $iframe.<span class="hljs-property">name</span>;   <span class="hljs-comment">// the response displayed in the named iframe</span><br>  $form.<span class="hljs-property">method</span> = <span class="hljs-string">&#x27;get&#x27;</span>;<br>  $form.<span class="hljs-property">style</span>.<span class="hljs-property">display</span> = <span class="hljs-string">&#x27;none&#x27;</span>;<br><br>  <span class="hljs-title class_">Object</span>.<span class="hljs-title function_">keys</span>(data).<span class="hljs-title function_">forEach</span>(<span class="hljs-function"><span class="hljs-params">key</span> =&gt;</span> &#123;<br>    <span class="hljs-keyword">const</span> node = <span class="hljs-variable language_">document</span>.<span class="hljs-title function_">createElement</span>(<span class="hljs-string">&#x27;input&#x27;</span>);<br>    node.<span class="hljs-property">name</span> = key;<br>    node.<span class="hljs-property">value</span> = data[key];<br>    $form.<span class="hljs-title function_">appendChild</span>(node);<br>  &#125;);<br><br>  <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">appendChild</span>($form);<br>  $form.<span class="hljs-title function_">submit</span>();<br><br>  <span class="hljs-variable language_">document</span>.<span class="hljs-property">body</span>.<span class="hljs-title function_">removeChild</span>($form);<br>&#125;;<br></code></pre></td></tr></table></figure>
<p>The disadvantage of this method is also very obvious: it cannot obtain the returned data.</p>
<h4 id="4-Proxy-and-forwarding"><a href="#4-Proxy-and-forwarding" class="headerlink" title="4. Proxy and forwarding"></a>4. Proxy and forwarding</h4><p>This method is relatively formal and takes advantage of the server’s lack of such restrictions. As long as the proxy or forwarding service domain name is of the same origin as the front-end domain name, it is sufficient: commonly, the front-end can initiate service forwarding on its own, middleware can return CORS configured headers, or nginx can perform reverse proxy.</p>
<p>The downside is that there is an additional layer of service, which increases server pressure and slows down the return speed to some extent.</p>
<h4 id="5-The-server-returns-CORS-response-header"><a href="#5-The-server-returns-CORS-response-header" class="headerlink" title="5. The server returns CORS response header"></a>5. The server returns CORS response header</h4><p>This is the most correct and conventional approach, and it fundamentally solves the cross domain problem once and for all, because this solution completely hands over permissions to the server, which controls whether to allow the frontend to obtain request responses.</p>
<p>If the downside is, it may be a browser compatibility issue, mainly requiring IE10 or above.</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Cross Orign 1</div>
      <div>https://han1015.github.io/dukeding.github.io/2024/06/24/Cross-Orign-1/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>Xiaohan Ding</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>June 24, 2024</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/dukeding.github.io/2024/06/30/Cross-Orign-2/" title="Cross Orign 2">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">Cross Orign 2</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/dukeding.github.io/2023/02/10/What-happens-when-you-type-a-URL-into-your-browser/" title="What happens when you type a URL into your browser?">
                        <span class="hidden-mobile">What happens when you type a URL into your browser?</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/dukeding.github.io/js/events.js" ></script>
<script  src="/dukeding.github.io/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/dukeding.github.io/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/dukeding.github.io/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/dukeding.github.io/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
